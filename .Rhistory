mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number())
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No"))
# Q3: What percentage do the top four Job Roles account for in terms of the total cost of attrition? ----
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_4) %>%
summarise(costs = sum(cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_4) %>%
summarise(total_attrrition_cost = sum(cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_4) %>%
summarise(total_attrrition_cost = sum(cost_of_attrition)) %>%
mutate(total_attririon_costs_pct = total_attrrition_cost/sum(total_attrrition_cost))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition))
# Second type of solution
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
mutate(sum_sum = cumsum(cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
mutate(cum_sum = cumsum(cost_of_attrition))
# Second type of solution
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
mutate(cum_sum = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_sum/sum(cum_sum))
# Second type of solution
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
mutate(cum_sum = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_sum/sum(cum_sum))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
%>% ungroup() %>%
mutate(cum_sum = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_sum/sum(cum_sum))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(cum_sum = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_sum/sum(cum_sum))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(cum_sum = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_sum/sum(cost_of_attrition))
# Second type of solution
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(cum_attrition = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_attrition/sum(cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
filter(JobRole == "Research Scientist") %>%
select(cost_of_attrition)
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(cum_attrition = cumsum(cost_of_attrition)) %>%
mutate(cum_pct = cum_attrition/sum(cost_of_attrition))
# Q4. Which Department has the highest total cost of attrition? ----
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
group_by(Department) %>%
summarise(sum = sum(cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition))
# First type of solution
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number())
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No"))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No"))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrrition_cost = sum(cost_of_attrition)) %>%
mutate(total_attririon_costs_pct = total_attrrition_cost/sum(total_attrrition_cost))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrrition_cost = sum(dept_cost_of_attrition))
# First type of solution
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrrition_cost = sum(dept_cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No"))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrition_cost = sum(dept_cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_4) %>%
summarise(total_attrrition_cost = sum(cost_of_attrition)) %>%
mutate(total_attririon_costs_pct = total_attrrition_cost/sum(total_attrrition_cost))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrition_cost = sum(dept_cost_of_attrition)) %>%
mutate(total_attrition_costs_pct = dept_cost_of_attrition/sum(dept_cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrition_cost = sum(dept_cost_of_attrition))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrition_cost = sum(dept_cost_of_attrition)) %>%
mutate(total_attrition_costs_pct = total_attrition_cost/sum(total_attrition_costn))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
group_by(Department) %>%
summarise(dept_cost_of_attrition = sum(cost_of_attrition)) %>%
arrange(desc(dept_cost_of_attrition)) %>%
mutate(row_num = row_number()) %>%
mutate(is_top_1 = case_when(row_num <= 1 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_1) %>%
summarise(total_attrition_cost = sum(dept_cost_of_attrition)) %>%
mutate(total_attrition_costs_pct = total_attrition_cost/sum(total_attrition_cost))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_4) %>%
summarise(total_attrrition_cost = sum(cost_of_attrition)) %>%
mutate(total_attrition_costs_pct = total_attrition_cost/sum(total_attrition_cost))
dept_jobrole_tbl %>%
count(Department, JobRole, Attrition) %>%
group_by(Department, JobRole) %>%
mutate(pct = n/sum(n)) %>%
filter(Attrition == "Yes") %>%
left_join(productivity_cost_by_role_tbl, by = c("Department", "JobRole")) %>%
mutate(cost_of_attrition = calculate_attrition_cost(salary = Salary_Average,
net_revenue_per_employee = Revenue_Average,
n = n)) %>%
arrange(desc(cost_of_attrition)) %>%
ungroup() %>%
mutate(row_num = row_number()) %>%
mutate(is_top_4 = case_when(row_num <= 4 ~ "Yes", TRUE ~ "No")) %>%
group_by(is_top_4) %>%
summarise(total_attrition_cost = sum(cost_of_attrition)) %>%
mutate(total_attrition_costs_pct = total_attrition_cost/sum(total_attrition_cost))
